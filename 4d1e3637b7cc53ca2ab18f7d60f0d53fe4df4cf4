{
  "comments": [
    {
      "key": {
        "uuid": "02522dad_dc1aadb4",
        "filename": "BUCK",
        "patchSetId": 7
      },
      "lineNbr": 15,
      "author": {
        "id": 1004034
      },
      "writtenOn": "2016-02-23T09:45:05Z",
      "side": 1,
      "message": "with this we get the classes from this bundle in lfs-storage-s3.jar, though I still face this problem\n\n[2016-02-23 10:34:22,417] [HTTP-54] ERROR com.google.gerrit.pgm.http.jetty.HiddenErrorHandler : Error in POST /lfstest.git/info/lfs/objects/batch\njava.lang.NoClassDefFoundError: org/eclipse/jgit/transport/http/apache/HttpClientConnectionFactory\n\tat org.eclipse.jgit.lfs.server.s3.S3Repository.getSize(S3Repository.java:150)\n\tat org.eclipse.jgit.lfs.server.TransferHandler$Upload.addObjectInfo(TransferHandler.java:105)\n\tat org.eclipse.jgit.lfs.server.TransferHandler$Upload.process(TransferHandler.java:91)\n\tat org.eclipse.jgit.lfs.server.LfsProtocolServlet.doPost(LfsProtocolServlet.java:109)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:648)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:729)\n\tat com.google.inject.servlet.ServletDefinition.doServiceImpl(ServletDefinition.java:287)\n\tat com.google.inject.servlet.ServletDefinition.doService(ServletDefinition.java:277)\n\tat com.google.inject.servlet.ServletDefinition.service(ServletDefinition.java:182)\n\tat com.google.inject.servlet.ManagedServletPipeline.service(ManagedServletPipeline.java:91)\n\tat com.google.gerrit.httpd.GetUserFilter.doFilter(GetUserFilter.java:82)\n\tat com.google.gwtexpui.server.CacheControlFilter.doFilter(CacheControlFilter.java:73)\n\tat com.google.gerrit.httpd.RunAsFilter.doFilter(RunAsFilter.java:117)\n\tat com.google.gerrit.httpd.RequestMetricsFilter.doFilter(RequestMetricsFilter.java:60)\n\tat com.google.gerrit.httpd.AllRequestFilter$FilterProxy$1.doFilter(AllRequestFilter.java:136)\n\tat com.google.gerrit.httpd.AllRequestFilter$FilterProxy.doFilter(AllRequestFilter.java:105)\n\tat com.google.gerrit.httpd.RequestContextFilter.doFilter(RequestContextFilter.java:75)\n\tat com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:119)\n\tat com.google.inject.servlet.GuiceFilter$1.call(GuiceFilter.java:133)\n\tat com.google.inject.servlet.GuiceFilter$1.call(GuiceFilter.java:130)\n\tat com.google.inject.servlet.GuiceFilter$Context.call(GuiceFilter.java:203)\n\tat com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:130)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:221)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1127)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1061)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\n\tat org.eclipse.jetty.server.handler.RequestLogHandler.handle(RequestLogHandler.java:95)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:499)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:311)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:257)\n\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.ClassNotFoundException: org.eclipse.jgit.transport.http.apache.HttpClientConnectionFactory\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:366)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:355)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:354)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:425)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:358)\n\t... 40 more\n\nLfsProtocolServlet is using S3Repository located in the lfs-storage-s3 plugin which needs HttpClientConnectionFactory\n\nDoes this mean we need to add the org.eclipse.jgit.http.apache dependency also to Gerrit core\u0027s dependencies or does the plugin need to export this for the core ?",
      "revId": "4d1e3637b7cc53ca2ab18f7d60f0d53fe4df4cf4",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e24c3916_7b5a7f59",
        "filename": "BUCK",
        "patchSetId": 7
      },
      "lineNbr": 15,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2016-02-23T10:55:21Z",
      "side": 1,
      "message": "Does it work, when you put \"org.eclipse.jgit:org.eclipse.jgit.http.apache\" in Gerrit core? You shouldn\u0027t need to export it in plugin. Exporting is only needed for compilation of artifacts that would depend on the plugin binary, what we don\u0027t have here.",
      "parentUuid": "02522dad_dc1aadb4",
      "revId": "4d1e3637b7cc53ca2ab18f7d60f0d53fe4df4cf4",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e24c3916_1b57bb30",
        "filename": "BUCK",
        "patchSetId": 7
      },
      "lineNbr": 15,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2016-02-23T10:57:49Z",
      "side": 1,
      "message": "According to the stack trace, lfs.server depends indirectly on org.eclipse.jgit.http.apache, sit probably should be pt in the Gerrit core and exported in the plugin-api, so that this plugin wouldn\u0027t need to pull in this dependency.",
      "parentUuid": "e24c3916_7b5a7f59",
      "revId": "4d1e3637b7cc53ca2ab18f7d60f0d53fe4df4cf4",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}